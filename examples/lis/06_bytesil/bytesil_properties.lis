// LIS Example: Propriedades de ByteSil
// Demonstra: Acesso a magnitude, fase, rho, theta
// Documentação: Seção 8.1

fn main() {
    print_string("=== ByteSil Properties ===");

    // =========================================
    // Criar ByteSil para testes
    // =========================================
    let bs1 = bytesil_new(8, 0);   // Magnitude média, fase 0
    let bs2 = bytesil_new(8, 4);   // Magnitude média, fase 90°
    let bs3 = bytesil_from_complex(3.0, 4.0);  // 3 + 4i

    // =========================================
    // Magnitude (bytesil_magnitude)
    // =========================================
    print_string("--- Magnitude ---");

    // Magnitude retorna o valor absoluto do número complexo
    let mag1 = bytesil_magnitude(bs1);
    print_string("magnitude of (rho=8, theta=0):");
    print_float(mag1);

    let mag2 = bytesil_magnitude(bs2);
    print_string("magnitude of (rho=8, theta=4):");
    print_float(mag2);

    let mag3 = bytesil_magnitude(bs3);
    print_string("magnitude of (3+4i) [should be 5]:");
    print_float(mag3);

    // Magnitude de constantes
    print_string("magnitude of bytesil_one():");
    print_float(bytesil_magnitude(bytesil_one()));

    print_string("magnitude of bytesil_null():");
    print_float(bytesil_magnitude(bytesil_null()));

    // =========================================
    // Fase em Radianos (bytesil_phase_radians)
    // =========================================
    print_string("--- Phase (radians) ---");

    let phase1 = bytesil_phase_radians(bs1);
    print_string("phase of (rho=8, theta=0) [should be ~0]:");
    print_float(phase1);

    let phase2 = bytesil_phase_radians(bs2);
    print_string("phase of (rho=8, theta=4) [should be ~pi/2]:");
    print_float(phase2);

    let phase3 = bytesil_phase_radians(bs3);
    print_string("phase of (3+4i) [should be ~0.927]:");
    print_float(phase3);

    // Fases especiais
    print_string("phase of bytesil_i() [should be ~pi/2]:");
    print_float(bytesil_phase_radians(bytesil_i()));

    print_string("phase of bytesil_neg_one() [should be ~pi]:");
    print_float(bytesil_phase_radians(bytesil_neg_one()));

    // =========================================
    // Fase em Graus (bytesil_phase_degrees)
    // =========================================
    print_string("--- Phase (degrees) ---");

    let deg0 = bytesil_phase_degrees(bytesil_new(8, 0));
    print_string("theta=0 in degrees [should be ~0]:");
    print_float(deg0);

    let deg4 = bytesil_phase_degrees(bytesil_new(8, 4));
    print_string("theta=4 in degrees [should be ~90]:");
    print_float(deg4);

    let deg8 = bytesil_phase_degrees(bytesil_new(8, 8));
    print_string("theta=8 in degrees [should be ~180]:");
    print_float(deg8);

    let deg12 = bytesil_phase_degrees(bytesil_new(8, 12));
    print_string("theta=12 in degrees [should be ~270]:");
    print_float(deg12);

    // =========================================
    // Rho (bytesil_rho) - Valor interno
    // =========================================
    print_string("--- Rho (internal value) ---");

    let rho1 = bytesil_rho(bs1);
    print_string("rho of (rho=8, theta=0):");
    print_int(rho1);

    let rho_zero = bytesil_rho(bytesil_null());
    print_string("rho of bytesil_null():");
    print_int(rho_zero);

    // =========================================
    // Theta (bytesil_theta) - Valor interno
    // =========================================
    print_string("--- Theta (internal value) ---");

    let theta1 = bytesil_theta(bs1);
    print_string("theta of (rho=8, theta=0):");
    print_int(theta1);

    let theta2 = bytesil_theta(bs2);
    print_string("theta of (rho=8, theta=4):");
    print_int(theta2);

    // =========================================
    // Relação entre Propriedades
    // =========================================
    print_string("--- Property Relationships ---");

    // Para um número complexo z = r * e^(iθ):
    // - magnitude = r
    // - phase = θ
    // - rho é a codificação log de r
    // - theta é a codificação de θ em 16 passos

    let test = bytesil_new(10, 6);

    print_string("Testing bytesil(10, 6):");
    print_string("  rho (internal):");
    print_int(bytesil_rho(test));
    print_string("  theta (internal):");
    print_int(bytesil_theta(test));
    print_string("  magnitude:");
    print_float(bytesil_magnitude(test));
    print_string("  phase (rad):");
    print_float(bytesil_phase_radians(test));
    print_string("  phase (deg):");
    print_float(bytesil_phase_degrees(test));

    // =========================================
    // Verificação de Consistência
    // =========================================
    print_string("--- Consistency Check ---");

    // Criar via cartesiano e verificar propriedades
    let cart = bytesil_from_complex(1.0, 1.0);
    let cart_mag = bytesil_magnitude(cart);
    let cart_phase = bytesil_phase_radians(cart);

    print_string("1+1i -> magnitude (expected ~1.414):");
    print_float(cart_mag);

    print_string("1+1i -> phase (expected ~0.785 = pi/4):");
    print_float(cart_phase);

    // Verificar sqrt(2)
    let sqrt2 = sqrt(2.0);
    print_string("sqrt(2) for reference:");
    print_float(sqrt2);
}
