// LIS Example: Funções Matemáticas Utilitárias
// Demonstra: floor, ceil, round, abs, min, max, pi
// Documentação: Seção 8.2

// =========================================
// Funções Compostas
// =========================================

// Clamp: limitar valor a um range
fn clamp(x: Float, min_val: Float, max_val: Float) -> Float {
    return min(max(x, min_val), max_val);
}

// Sign function
fn sign(x: Float) -> Float {
    if x > 0.0 {
        return 1.0;
    }
    if x < 0.0 {
        return -1.0;
    }
    return 0.0;
}

// =========================================
// Aplicações
// =========================================

// Truncar para N casas decimais
fn truncate_decimals(x: Float, decimals: Int) -> Float {
    let factor = 1.0;
    let i = 0;
    loop {
        if i >= decimals {
            break;
        }
        let factor = factor * 10.0;
        let i = i + 1;
    }
    return floor(x * factor) / factor;
}

// Distância entre dois pontos
fn distance(x1: Float, y1: Float, x2: Float, y2: Float) -> Float {
    let dx = x2 - x1;
    let dy = y2 - y1;
    return sqrt(dx * dx + dy * dy);
}

// Mínimo de 3 valores
fn min3(a: Float, b: Float, c: Float) -> Float {
    return min(min(a, b), c);
}

// Máximo de 3 valores
fn max3(a: Float, b: Float, c: Float) -> Float {
    return max(max(a, b), c);
}

fn main() {
    print_string("=== Math Utility Functions ===");

    // =========================================
    // Constante Pi (pi)
    // =========================================
    print_string("--- pi() ---");

    let pi_val = pi();
    print_string("pi =");
    print_float(pi_val);  // ~3.14159

    print_string("2*pi =");
    print_float(pi_val * 2.0);

    print_string("pi/2 =");
    print_float(pi_val / 2.0);

    // =========================================
    // Arredondar para Baixo (floor)
    // =========================================
    print_string("--- floor(x) ---");

    print_string("floor(3.7) =");
    print_float(floor(3.7));  // 3

    print_string("floor(3.2) =");
    print_float(floor(3.2));  // 3

    print_string("floor(3.0) =");
    print_float(floor(3.0));  // 3

    print_string("floor(-3.2) =");
    print_float(floor(-3.2));  // -4

    print_string("floor(-3.7) =");
    print_float(floor(-3.7));  // -4

    // =========================================
    // Arredondar para Cima (ceil)
    // =========================================
    print_string("--- ceil(x) ---");

    print_string("ceil(3.2) =");
    print_float(ceil(3.2));  // 4

    print_string("ceil(3.7) =");
    print_float(ceil(3.7));  // 4

    print_string("ceil(3.0) =");
    print_float(ceil(3.0));  // 3

    print_string("ceil(-3.2) =");
    print_float(ceil(-3.2));  // -3

    print_string("ceil(-3.7) =");
    print_float(ceil(-3.7));  // -3

    // =========================================
    // Arredondar (round)
    // =========================================
    print_string("--- round(x) ---");

    print_string("round(3.4) =");
    print_float(round(3.4));  // 3

    print_string("round(3.5) =");
    print_float(round(3.5));  // 4

    print_string("round(3.6) =");
    print_float(round(3.6));  // 4

    print_string("round(-3.4) =");
    print_float(round(-3.4));  // -3

    print_string("round(-3.5) =");
    print_float(round(-3.5));  // -4 ou -3 dependendo da implementação

    // =========================================
    // Valor Absoluto (abs)
    // =========================================
    print_string("--- abs(x) ---");

    print_string("abs(5) =");
    print_float(abs(5.0));  // 5

    print_string("abs(-5) =");
    print_float(abs(-5.0));  // 5

    print_string("abs(0) =");
    print_float(abs(0.0));  // 0

    print_string("abs(-3.14) =");
    print_float(abs(-3.14));  // 3.14

    // =========================================
    // Mínimo (min)
    // =========================================
    print_string("--- min(a, b) ---");

    print_string("min(3, 5) =");
    print_float(min(3.0, 5.0));  // 3

    print_string("min(5, 3) =");
    print_float(min(5.0, 3.0));  // 3

    print_string("min(-2, 2) =");
    print_float(min(-2.0, 2.0));  // -2

    print_string("min(7, 7) =");
    print_float(min(7.0, 7.0));  // 7

    // =========================================
    // Máximo (max)
    // =========================================
    print_string("--- max(a, b) ---");

    print_string("max(3, 5) =");
    print_float(max(3.0, 5.0));  // 5

    print_string("max(5, 3) =");
    print_float(max(5.0, 3.0));  // 5

    print_string("max(-2, 2) =");
    print_float(max(-2.0, 2.0));  // 2

    print_string("max(-5, -3) =");
    print_float(max(-5.0, -3.0));  // -3

    // =========================================
    // Funções Compostas
    // =========================================
    print_string("--- Composite Functions ---");

    print_string("clamp(15, 0, 10) =");
    print_float(clamp(15.0, 0.0, 10.0));  // 10

    print_string("clamp(-5, 0, 10) =");
    print_float(clamp(-5.0, 0.0, 10.0));  // 0

    print_string("clamp(5, 0, 10) =");
    print_float(clamp(5.0, 0.0, 10.0));  // 5

    print_string("sign(10) =");
    print_float(sign(10.0));  // 1

    print_string("sign(-10) =");
    print_float(sign(-10.0));  // -1

    print_string("sign(0) =");
    print_float(sign(0.0));  // 0

    // =========================================
    // Aplicações
    // =========================================
    print_string("--- Applications ---");

    print_string("truncate 3.14159 to 2 decimals:");
    print_float(truncate_decimals(3.14159, 2));  // 3.14

    print_string("Distance from (0,0) to (3,4):");
    print_float(distance(0.0, 0.0, 3.0, 4.0));  // 5

    print_string("min(7, 3, 5) =");
    print_float(min3(7.0, 3.0, 5.0));  // 3

    print_string("max(7, 3, 5) =");
    print_float(max3(7.0, 3.0, 5.0));  // 7
}
