// LIS Example: Funções Exponenciais e Logarítmicas
// Demonstra: sqrt, exp, ln, log2, log10
// Documentação: Seção 8.2

// =========================================
// Conversão entre Bases
// =========================================

// log_b(x) = ln(x) / ln(b)
fn log_base(x: Float, base: Float) -> Float {
    return ln(x) / ln(base);
}

// =========================================
// Aplicações
// =========================================

// Decibels: dB = 10 * log10(P/P_ref)
fn to_decibels(power: Float, reference: Float) -> Float {
    return 10.0 * log10(power / reference);
}

// Information entropy: -sum(p * log2(p))
fn binary_entropy(p: Float) -> Float {
    if p <= 0.0 {
        return 0.0;
    }
    if p >= 1.0 {
        return 0.0;
    }
    let q = 1.0 - p;
    return 0.0 - p * log2(p) - q * log2(q);
}

// Compound interest: A = P * e^(rt)
fn compound_continuous(principal: Float, rate: Float, time: Float) -> Float {
    return principal * exp(rate * time);
}

fn main() {
    print_string("=== Exponential & Logarithmic Functions ===");

    // =========================================
    // Raiz Quadrada (sqrt)
    // =========================================
    print_string("--- sqrt(x) ---");

    print_string("sqrt(4) =");
    print_float(sqrt(4.0));  // 2

    print_string("sqrt(2) =");
    print_float(sqrt(2.0));  // ~1.414

    print_string("sqrt(9) =");
    print_float(sqrt(9.0));  // 3

    print_string("sqrt(0.25) =");
    print_float(sqrt(0.25));  // 0.5

    print_string("sqrt(100) =");
    print_float(sqrt(100.0));  // 10

    // =========================================
    // Exponencial (exp)
    // =========================================
    print_string("--- exp(x) ---");

    // e^x onde e ≈ 2.71828
    print_string("exp(0) =");
    print_float(exp(0.0));  // 1

    print_string("exp(1) = e =");
    print_float(exp(1.0));  // ~2.718

    print_string("exp(2) = e^2 =");
    print_float(exp(2.0));  // ~7.389

    print_string("exp(-1) = 1/e =");
    print_float(exp(-1.0));  // ~0.368

    print_string("exp(0.5) =");
    print_float(exp(0.5));  // ~1.649

    // =========================================
    // Logaritmo Natural (ln)
    // =========================================
    print_string("--- ln(x) ---");

    // ln(x) = log base e
    print_string("ln(1) =");
    print_float(ln(1.0));  // 0

    print_string("ln(e) =");
    print_float(ln(exp(1.0)));  // 1

    print_string("ln(e^2) =");
    print_float(ln(exp(2.0)));  // 2

    print_string("ln(10) =");
    print_float(ln(10.0));  // ~2.303

    print_string("ln(0.5) =");
    print_float(ln(0.5));  // ~-0.693

    // =========================================
    // Logaritmo Base 2 (log2)
    // =========================================
    print_string("--- log2(x) ---");

    print_string("log2(1) =");
    print_float(log2(1.0));  // 0

    print_string("log2(2) =");
    print_float(log2(2.0));  // 1

    print_string("log2(4) =");
    print_float(log2(4.0));  // 2

    print_string("log2(8) =");
    print_float(log2(8.0));  // 3

    print_string("log2(1024) =");
    print_float(log2(1024.0));  // 10

    print_string("log2(0.5) =");
    print_float(log2(0.5));  // -1

    // =========================================
    // Logaritmo Base 10 (log10)
    // =========================================
    print_string("--- log10(x) ---");

    print_string("log10(1) =");
    print_float(log10(1.0));  // 0

    print_string("log10(10) =");
    print_float(log10(10.0));  // 1

    print_string("log10(100) =");
    print_float(log10(100.0));  // 2

    print_string("log10(1000) =");
    print_float(log10(1000.0));  // 3

    print_string("log10(0.1) =");
    print_float(log10(0.1));  // -1

    // =========================================
    // Identidades
    // =========================================
    print_string("--- Identities ---");

    let x = 5.0;

    // exp(ln(x)) = x
    let exp_ln = exp(ln(x));
    print_string("exp(ln(5)) = (should be 5)");
    print_float(exp_ln);

    // ln(exp(x)) = x
    let ln_exp = ln(exp(x));
    print_string("ln(exp(5)) = (should be 5)");
    print_float(ln_exp);

    // sqrt(x)^2 = x
    let sqrt_squared = sqrt(x) * sqrt(x);
    print_string("sqrt(5)^2 = (should be 5)");
    print_float(sqrt_squared);

    // log2(2^x) = x
    let log2_power = log2(exp(x * ln(2.0)));
    print_string("log2(2^5) = (should be 5)");
    print_float(log2_power);

    // =========================================
    // Conversão entre Bases
    // =========================================
    print_string("--- Base Conversion ---");

    print_string("log_3(27) = (should be 3)");
    print_float(log_base(27.0, 3.0));

    print_string("log_5(125) = (should be 3)");
    print_float(log_base(125.0, 5.0));

    // =========================================
    // Aplicações
    // =========================================
    print_string("--- Applications ---");

    print_string("100 / 1 in dB:");
    print_float(to_decibels(100.0, 1.0));  // 20 dB

    print_string("Binary entropy of 0.5 (max):");
    print_float(binary_entropy(0.5));  // 1.0

    print_string("Binary entropy of 0.9:");
    print_float(binary_entropy(0.9));  // ~0.469

    print_string("$1000 at 5% for 10 years (continuous):");
    print_float(compound_continuous(1000.0, 0.05, 10.0));  // ~$1648.72
}
